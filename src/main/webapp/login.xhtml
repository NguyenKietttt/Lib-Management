<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:t="http://xmlns.jcp.org/jsf/passthrough">
    <h:head>
        <f:metadata>
            <f:viewAction action="#{accountBean.checkLogin()}"></f:viewAction>
        </f:metadata>
        <title>Login</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <h:outputStylesheet name="css/bootstrap.min.css"></h:outputStylesheet>
        <h:outputStylesheet name="fonts/fontawesome-all.min.css"></h:outputStylesheet>
    </h:head>
    <h:body class="bg-gradient-primary">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-9 col-lg-12 col-xl-10">
                    <div class="card shadow-lg o-hidden border-0 my-5">
                        <div class="card-body p-0">
                            <div class="row">
                                <div class="col-lg-6 offset-lg-3">
                                    <div class="p-5">
                                        <div class="text-center">
                                            <h4 class="text-dark mb-4">LOGIN FORM</h4>
                                        </div>
                                        <h:form id="fo" class="user">
                                            <div class="form-group">
                                                <label><strong>UserName</strong><br/></label>
                                                <h:message style="color: red" for="username" />
                                                <div id="alertUpdate" role="alert" class="alert alert-danger" style="display: none">
                                                    <h:outputText id="notification" value="#{accountBean.message}"></h:outputText>
                                                </div>
                                                <h:inputText id="username" class="form-control form-control-user" 
                                                             t:placeholder="Username" 
                                                             style="font-size: 12.8px;"
                                                             value="#{accountBean.accountID}"
                                                             required="true" requiredMessage=" *"/>
                                            </div>
                                            <div class="form-group">
                                                <label><strong>Password</strong><br/></label>
                                                <h:message style="color: red" for="password" />
                                                <h:inputSecret id="password" class="form-control form-control-user" 
                                                             t:placeholder="Password" 
                                                             redisplay="true"
                                                             style="font-size: 12.8px;" 
                                                             required="true" requiredMessage=" *"
                                                             value="#{accountBean.password}"/>
                                            </div>
                                            <h:commandButton class="btn btn-primary btn-block text-white btn-user" type="submit" value="Login">
                                                <f:ajax execute="@form" listener="#{accountBean.loginAccount()}"
                                                    render="@form"
                                                    onevent="loginFail"/>
                                            </h:commandButton>
                                            <hr/>
                                        </h:form>
                                        <div class="text-center"></div>
                                        <div class="text-center"><h:link class="small" outcome="register.xhtml">Create an Account!</h:link></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <h:outputScript name="js/jquery.min.js"></h:outputScript>
        <h:outputScript name="js/bootstrap.min.js"></h:outputScript>
        <h:outputScript name="js/theme.js"></h:outputScript>
        <script>
            if(window.history.replaceState){
                window.history.replaceState(null, null, window.location.href);
            }
            
            function loginFail(data) {
                if (data.status == "success") {
                    var acc = document.getElementById('fo:username').value;
                    var pass = document.getElementById('fo:password').value;

                    var temp = document.getElementById('fo:notification').innerHTML;

                    if (temp !== "") {
                        if (acc !== null &amp;&amp; acc !== "") {
                            if (pass !== null &amp;&amp; pass !== "") {
                                document.getElementById("alertUpdate").style.display = "block";
                                window.scrollTo({ top: 0, behavior: 'smooth' });
                            }
                        }
                    }
                }
            }
            
        </script>
    </h:body>
</html>
